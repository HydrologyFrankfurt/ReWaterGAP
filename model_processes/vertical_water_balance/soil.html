
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Soil &#8212; ReWaterGAP dev documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="../../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../../_static/documentation_options.js?v=3ce10a4d"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'model_processes/vertical_water_balance/soil';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_version = '0.16.1';
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://raw.githubusercontent.com/HydrologyFrankfurt/ReWaterGAP/refs/heads/main/docs/versions.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'dev';
        DOCUMENTATION_OPTIONS.show_version_warning_banner =
            false;
        </script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Lateral Water Balance" href="../lateral_water_balance/index.html" />
    <link rel="prev" title="Snow" href="snow.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="dev" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/watergap_logo.png" class="logo__image only-light" alt="ReWaterGAP dev documentation - Home"/>
    <img src="../../_static/watergap_logo.png" class="logo__image only-dark pst-js-only" alt="ReWaterGAP dev documentation - Home"/>
  
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting_started/index.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Model Processes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contributers_guide/index.html">
    Contributers Guide
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-2"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-2"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-2"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-2">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/HydrologyFrankfurt/ReWaterGAP" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/HydroFrankfurt" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../getting_started/index.html">
    Getting started
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../user_guide/index.html">
    User Guide
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="../index.html">
    Model Processes
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../../contributers_guide/index.html">
    Contributers Guide
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<div class="version-switcher__container dropdown pst-js-only">
  <button id="pst-version-switcher-button-3"
    type="button"
    class="version-switcher__button btn btn-sm dropdown-toggle"
    data-bs-toggle="dropdown"
    aria-haspopup="listbox"
    aria-controls="pst-version-switcher-list-3"
    aria-label="Version switcher list"
  >
    Choose version  <!-- this text may get changed later by javascript -->
    <span class="caret"></span>
  </button>
  <div id="pst-version-switcher-list-3"
    class="version-switcher__menu dropdown-menu list-group-flush py-0"
    role="listbox" aria-labelledby="pst-version-switcher-button-3">
    <!-- dropdown will be populated by javascript on page load -->
  </div>
</div></div>
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/HydrologyFrankfurt/ReWaterGAP" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/HydroFrankfurt" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-square-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Vertical Water Balance</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="radiation_evapotranspiration.html">Radiation and Evapotranspiration</a></li>

<li class="toctree-l2"><a class="reference internal" href="leafareaindex.html">Leaf Area Index</a></li>

<li class="toctree-l2"><a class="reference internal" href="canopy.html">Canopy</a></li>

<li class="toctree-l2"><a class="reference internal" href="snow.html">Snow</a></li>

<li class="toctree-l2 current active"><a class="current reference internal" href="#">Soil</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../lateral_water_balance/index.html">Lateral Water Balance</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../lateral_water_balance/groundwater.html">Groundwater</a></li>

<li class="toctree-l2"><a class="reference internal" href="../lateral_water_balance/lakes_wetlands.html">Lakes and wetlands</a></li>

<li class="toctree-l2"><a class="reference internal" href="../lateral_water_balance/reservoir_regulated_lakes.html">Reservoirs</a></li>

<li class="toctree-l2"><a class="reference internal" href="../lateral_water_balance/river.html">River</a></li>

<li class="toctree-l2"><a class="reference internal" href="../lateral_water_balance/net_abstractions.html">Net abstractions</a></li>

</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../gwswuse/index.html">Groundwater Surface Water Use</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../gwswuse/simulation_logic.html">Simulation Logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gwswuse/irrigation_simulation.html">Irrigation Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gwswuse/domestic_simulation.html">Domestic Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gwswuse/manufacturing_simulation.html">Manufacturing Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gwswuse/thermal_power_simulation.html">Thermal Power Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gwswuse/livestock_simulation.html">Livestock Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gwswuse/cross_sectoral_aggregate_results.html">Cross-Sectoral Aggregate Results</a></li>
</ul>
</details></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Model Processes</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Vertical Water Balance</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Soil</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="soil">
<span id="id1"></span><h1>Soil<a class="headerlink" href="#soil" title="Link to this heading">#</a></h1>
<p>This module computes soil storage and related fluxes for all grid cells based on section 4.4 of Müller Schmied et al 2021 <a class="footnote-reference brackets" href="#id7" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="soil.soil_water_balance">
<span class="sig-prename descclassname"><span class="pre">soil.</span></span><span class="sig-name descname"><span class="pre">soil_water_balance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">soil_water_content</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pet_to_soil</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_landarea_frac</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">landareafrac_ratio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_temp_elev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">canopy_evap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">effective_precipitation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precipitation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">immediate_runoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">land_storage_change_sum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sublimation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">daily_storage_transfer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">snow_freeze_temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_daily_pet</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">humid_arid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soil_texture</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drainage_direction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_groundwater_recharge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groundwater_recharge_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">critcal_gw_precipitation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_soil_water_content</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">areal_corr_factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minstorage_volume</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/soil.html#soil_water_balance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#soil.soil_water_balance" title="Link to this definition">#</a></dt>
<dd><p>Compute daily soil balance.</p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl>
<dt><strong>soil_water_content</strong><span class="classifier">float</span></dt><dd><p>Soil water content, Units: [mm]</p>
</dd>
<dt><strong>pet_to_soil</strong><span class="classifier">float</span></dt><dd><p>Remaining energy for addtional evaporation from soil, Units: [mm]</p>
</dd>
<dt><strong>current_landarea_frac</strong><span class="classifier">float</span></dt><dd><p>Land area fraction of current time step,  Units: [-]</p>
</dd>
<dt><strong>landareafrac_ratio</strong><span class="classifier">float</span></dt><dd><dl class="simple">
<dt>Ratio of land area fraction of previous to current time step,</dt><dd><p>Units: [-]</p>
</dd>
</dl>
</dd>
<dt><strong>max_temp_elev</strong><span class="classifier">float</span></dt><dd><p>Maximum temperature from the 1st(lowest) elevation from snow
algorithm. , Units: [K]</p>
</dd>
<dt><strong>canopy_evap</strong><span class="classifier">float</span></dt><dd><p>Canopy evaporation,  Units: [mm/day]</p>
</dd>
<dt><strong>effective_precipitation</strong><span class="classifier">float</span></dt><dd><p>Effective precipitation based on  Müller Schmied et al 2021,
Units: [mm/day]</p>
</dd>
<dt><strong>precipitation</strong><span class="classifier">float</span></dt><dd><p>Daily precipitation,  Units: [mm/day]</p>
</dd>
<dt><strong>immediate_runoff</strong><span class="classifier">float</span></dt><dd><p>Immediate runoff, Units: [mm/day]</p>
</dd>
<dt><strong>land_storage_change_sum</strong><span class="classifier">float</span></dt><dd><p>Sum of change in vertical balance storages, Units: [mm]</p>
</dd>
<dt><strong>sublimation</strong><span class="classifier">float</span></dt><dd><p>Sublimation, Units: [mm/day]</p>
</dd>
<dt><strong>daily_storage_transfer</strong><span class="classifier">float</span></dt><dd><p>Storage to be transfered to runoff when land area fraction of
current time step is zero, Units: [mm]</p>
</dd>
<dt><strong>snow_freeze_temp</strong><span class="classifier">float</span></dt><dd><p>Snow freeze temperature  , Units:  [K]</p>
</dd>
<dt><strong>gamma</strong><span class="classifier">float</span></dt><dd><p>Runoff coefficient , Units:  [-]</p>
</dd>
<dt><strong>max_daily_pet</strong><span class="classifier">float</span></dt><dd><p>Maximum daily potential evapotranspiration, Units:  [mm/day]</p>
</dd>
<dt><strong>humid_arid</strong><span class="classifier">float</span></dt><dd><p>Humid-arid calssification based on Müller Schmied et al. 2021</p>
</dd>
<dt><strong>soil_texture</strong><span class="classifier">float</span></dt><dd><p>Soil texture classification based on Müller Schmied et al. 2021</p>
</dd>
<dt><strong>drainage_direction</strong><span class="classifier">float</span></dt><dd><p>Drainage direction based on Müller Schmied et al. 2021</p>
</dd>
<dt><strong>max_groundwater_recharge</strong><span class="classifier">float</span></dt><dd><p>Maximum groundwater recharge from soil, Units: [mm/day]</p>
</dd>
<dt><strong>groundwater_recharge_factor</strong><span class="classifier">float</span></dt><dd><p>Groundwater recharge factor, Units:  [-]</p>
</dd>
<dt><strong>critcal_gw_precipitation</strong><span class="classifier">float</span></dt><dd><p>critical precipitation for groundwater recharge, Units: [mm/day]</p>
</dd>
<dt><strong>max_soil_water_content</strong><span class="classifier">float</span></dt><dd><p>Maximum soil water content , Units: [mm]</p>
</dd>
<dt><strong>areal_corr_factor</strong><span class="classifier">float</span></dt><dd><p>Areal correction factor-CFA for correcting runoff,  Units:  [-]</p>
</dd>
<dt><strong>minstorage_volume</strong><span class="classifier">float</span></dt><dd><blockquote>
<div><p>Volume at which storage is set to zero, Units: [km3]</p>
</div></blockquote>
<p>x, y : Latititude and longitude indexes of grid cells.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>soil_water_content</strong><span class="classifier">float</span></dt><dd><p>Updated soil water content , Units: [mm]</p>
</dd>
<dt><strong>groundwater_recharge_from_soil_mm</strong><span class="classifier">float</span></dt><dd><p>Groundwater recharge from soil, Units: [mm/day]</p>
</dd>
<dt><strong>actual_soil_evap</strong><span class="classifier">float</span></dt><dd><p>Actual evapotranspiration from the soil, Units: [mm/day]</p>
</dd>
<dt><strong>soil_saturation</strong><span class="classifier">float</span></dt><dd><p>Soil saturation, Units: [-]</p>
</dd>
<dt><strong>surface_runoff</strong><span class="classifier">float</span></dt><dd><p>Surface runoff from land, Units: [mm/day]</p>
</dd>
<dt><strong>daily_storage_transfer</strong><span class="classifier">float</span></dt><dd><p>Updated storage to be transfered to runoff when land area fraction
of current time step is zero, Units: [mm]</p>
</dd>
<dt><strong>total_daily_runoff</strong><span class="classifier">float</span></dt><dd><p>Total daily runoff from land (RL)
(runoff + immediate runoff + soil water overflow), Units: [mm/day]</p>
</dd>
<dt><strong>daily_runoff</strong><span class="classifier">float</span></dt><dd><p>daily runoff (R3), Bergström (1995),  Units: [mm/day]</p>
</dd>
<dt><strong>soil_water_overflow</strong><span class="classifier">float</span></dt><dd><p>Soil water overflow (R2), Units: [mm/day]</p>
</dd>
<dt><strong>immediate_runoff</strong><span class="classifier">float</span></dt><dd><p>runoff from urban areas or immediate runoff (R1), Units: [mm/day]</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The computation order for the soil storage module is as follows:
First, <a class="reference internal" href="#immediate-runoff"><span class="std std-ref">immediate runoff (R1)</span></a> is calculated. After,
<a class="reference internal" href="#effective-precipitation"><span class="std std-ref">effective precipitation</span></a> is reduced by the immediate runoff. Then, runoff from <a class="reference internal" href="#overflow"><span class="std std-ref">soil water overflow (R2)</span></a> is computed.
After, <a class="reference internal" href="#runoff"><span class="std std-ref">daily runoff (R3)</span></a> is calculated followed by <a class="reference internal" href="#actual-evapotranspiration"><span class="std std-ref">actual evapotranspiration</span></a>.
Soil storage is updated. Afterwards, <a class="reference internal" href="#diffuse-groundwater-recharge"><span class="std std-ref">ground water recharge</span></a> is calculated
based on daily runoff. Then, <a class="reference internal" href="#total-daily-runoff"><span class="std std-ref">total daily runoff from land (RL)</span></a> is computed as daily runoff (R3) + immediate runoff (R1) + soil water overflow
(R2).</p>
<p><strong>Note</strong>: Total daily runoff from land is corrected with an areal correction factor (CFA) (if gamma is insufficient to fit simulated discharge). To conserve
water balance, <a class="reference internal" href="#corrected-evap"><span class="std std-ref">actual evapotranspiration</span></a> is also corrected with CFA. After evapotranspiration correction, soil storage, total daily runoff from
land and groundwater recharge are adjusted as well. Finally, <em>Surface runoff</em> <span class="math notranslate nohighlight">\(({R}_{s})\)</span> is calculated as total daily runoff from land minus groundwater recharge.</p>
</div>
<section id="water-balance">
<h2>Water balance<a class="headerlink" href="#water-balance" title="Link to this heading">#</a></h2>
<p id="soil-storage">Soil storage <span class="math notranslate nohighlight">\(S_s\)</span> <span class="math notranslate nohighlight">\([mm]\)</span> is calculated as:</p>
<div class="math notranslate nohighlight">
\[\frac{dS_s}{d_t} =  {P}_{eff} − {R}_{l}− {E}_{s}\]</div>
<p>where <span class="math notranslate nohighlight">\({P}_{eff}\)</span> is effective precipitation <span class="math notranslate nohighlight">\([mm/d]\)</span>, <span class="math notranslate nohighlight">\({R}_{l}\)</span> is total runoff from land <span class="math notranslate nohighlight">\([mm/d]\)</span> and <span class="math notranslate nohighlight">\({E}_{s}\)</span> is  the actual evapotranspiration from soil <span class="math notranslate nohighlight">\([mm/d]\)</span>.</p>
</section>
<section id="inflows">
<h2>Inflows<a class="headerlink" href="#inflows" title="Link to this heading">#</a></h2>
<p>Effective precipitation <span class="math notranslate nohighlight">\({P}_{eff}\)</span> is calculated as:</p>
<div class="math notranslate nohighlight" id="effective-precipitation">
\[{P}_{eff} = {P}_{t} − {P}_{sn} + {M}\]</div>
<p>where <span class="math notranslate nohighlight">\({P}_{t}\)</span> is throughfall <span class="math notranslate nohighlight">\([mm/d]\)</span>, <span class="math notranslate nohighlight">\({P}_{sn}\)</span> is snowfall <span class="math notranslate nohighlight">\([mm/d]\)</span> and <span class="math notranslate nohighlight">\({M}\)</span> is snow melt <span class="math notranslate nohighlight">\([mm/d]\)</span>.</p>
<p>Actual evapotranspiration <span class="math notranslate nohighlight">\({E}_{s}\)</span> from soil <span class="math notranslate nohighlight">\([mm/d]\)</span> is calculated as:</p>
<div class="math notranslate nohighlight" id="actual-evapotranspiration">
\[{E}_{s} = min\biggl(({E}_{pot} - E_c) , ({E}_{pot,max} - E_c) \times \frac{S_s}{S_s,max} \biggr)\]</div>
<p>where <span class="math notranslate nohighlight">\({E}_{pot}\)</span> is potential evapotranspiration <span class="math notranslate nohighlight">\([mm/d]\)</span>, <span class="math notranslate nohighlight">\({E}_{c}\)</span> is canopy evaporation <span class="math notranslate nohighlight">\([mm/d]\)</span> and <span class="math notranslate nohighlight">\({S}_{s,max}\)</span> is the maximum soil water content <span class="math notranslate nohighlight">\([mm]\)</span> derived as a product of total available water capacity in the upper meter of the soil <a class="footnote-reference brackets" href="#id8" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> and land-cover-specific rooting depth (Table C2 <a class="footnote-reference brackets" href="#id7" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>). The maximum potential evapotranspiration <span class="math notranslate nohighlight">\({E}_{pot,max}\)</span> is set to <span class="math notranslate nohighlight">\(15 {mm}/{d}\)</span> globally.</p>
<p>Total daily runoff from land (RL) is calculated as:</p>
<div class="math notranslate nohighlight" id="total-daily-runoff">
\[RL = R1 + R3 + R2\]</div>
<p>where immediate runoff from urban areas (R1) is computed as:</p>
<div class="math notranslate nohighlight" id="immediate-runoff">
\[{immediate \: runoff} = 0.5 \times {P}_{eff} \times fraction \: of \: build \: up \: area\]</div>
<p>and where soil water overflow (R2) is calculated as:</p>
<div class="math notranslate nohighlight" id="overflow">
\[\begin{split}{P}_{eff} =
\begin{cases}
{P}_{eff} +{S}_{s,p} - {S_s,max}, &amp; \text{if } ({P}_{eff} + {S}_{s,p})&gt;{S_s}_{,max} \\
0, &amp; \text{otherwise}
\end{cases}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\({P}_{eff}\)</span> is <a class="reference internal" href="#effective-precipitation"><span class="std std-ref">effective precipitation</span></a>, <span class="math notranslate nohighlight">\({S}_{s,p}\)</span> and <span class="math notranslate nohighlight">\({S}_{s,max}\)</span> is <a class="reference internal" href="#soil-storage"><span class="std std-ref">soil storage</span></a>
of the previous day and maximum soil storage respectively.</p>
<p>Daily runoff from soil (<span class="math notranslate nohighlight">\({R3}\)</span>) <span class="math notranslate nohighlight">\([mm/day]\)</span> is calculated following Bergström (1995) <a class="footnote-reference brackets" href="#id9" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> as:</p>
<div class="math notranslate nohighlight" id="runoff">
\[R3 = {P}_{eff} \biggl(\frac{S_s}{S_s,max}\biggr)^\Gamma\]</div>
<p>where Gamma is the runoff coefficient <span class="math notranslate nohighlight">\([–]\)</span>. This parameter, which varies between :math`0.1` and <span class="math notranslate nohighlight">\(5.0\)</span>, is used for calibration.
Together with soil saturation, it determines the fraction of <span class="math notranslate nohighlight">\({P}_{eff}\)</span> that becomes <span class="math notranslate nohighlight">\({R3}\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the sum of <span class="math notranslate nohighlight">\({P}_{eff}\)</span> and <span class="math notranslate nohighlight">\({S}_{s}\)</span> of the previous day exceed <span class="math notranslate nohighlight">\({S}_{s,max}\)</span>, the overflow <span class="math notranslate nohighlight">\({R2}\)</span> is added to
daily runoff <span class="math notranslate nohighlight">\({R3}\)</span> and immediate runoff <span class="math notranslate nohighlight">\({R1}\)</span> to total daily runoff from land <span class="math notranslate nohighlight">\({R}_{L}\)</span>.</p>
</div>
<p><span class="math notranslate nohighlight">\({R3}\)</span> is partitioned into fast surface and subsurface runoff <span class="math notranslate nohighlight">\({R}_{s}\)</span> and diffuse groundwater recharge <span class="math notranslate nohighlight">\({R}_{g}\)</span> according to the <a class="reference internal" href="../../getting_started/model_framework.html#model-schematic"><span class="std std-ref">heuristic scheme</span></a>.</p>
<div class="math notranslate nohighlight" id="diffuse-groundwater-recharge">
\[{R}_{g} = min\biggl({R}_{gmax} , ({f}_{g} \times {R3} \biggr)\]</div>
<p>where <span class="math notranslate nohighlight">\({R}_{gmax}\)</span> is soil-texture-specific maximum groundwater recharge with values of 7, 4.5 and 2.5 <span class="math notranslate nohighlight">\([mm/d]\)</span> for sandy,
loamy and clayey soils, respectively, and <span class="math notranslate nohighlight">\({f}_{g}\)</span> is the groundwater recharge factor ranging between 0 and 1. <span class="math notranslate nohighlight">\({f}_{g}\)</span> is determined
based on relief, soil texture, aquifer type, and the existence of permafrost or glaciers <a class="footnote-reference brackets" href="#id10" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If a grid cell is defined as (semi)arid and has coarse (sandy) soil, groundwater recharge will only occur if precipitation exceeds a critical value of 12.5 <span class="math notranslate nohighlight">\([mm/d]\)</span>, otherwise the water remains in the soil. The fraction of <span class="math notranslate nohighlight">\({R}_{3}\)</span> that does not recharge the groundwater becomes <span class="math notranslate nohighlight">\({R}_{s}\)</span>, which recharges surface water bodies and the river compartment.</p>
</div>
<p>If the gamma parameter is not enough to match the observed discharge, the total daily runoff from land is adjusted by multiplying it with a real correction factor (CFA). To conserve mass balance actual total evaporation from land (<span class="math notranslate nohighlight">\({E}_{s}\)</span>) is corrected such that when a real
correction factor is increased or reduced to increase runoff, actual total evaporation will also be reduced or increased respectively.</p>
<div class="math notranslate nohighlight" id="corrected-evap">
\[\begin{split}RL &amp;= P - E_s - \frac{dS}{dt}, (dt=1), eqn.1, \\ RL \times CFA &amp;= P - {E}_{s,corr} - dS,eqn2,\end{split}\]</div>
<p>substituting <span class="math notranslate nohighlight">\(RL\)</span> from equation 2 into equation 1:</p>
<div class="math notranslate nohighlight">
\[\begin{split}P - {E}_{s,corr} - ds &amp;= CFA (P - E_s - ds), \\ {E}_{s,corr} &amp;= dS(CFA-1) - P(CFA-1) + E_s(CFA)\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\({P}\)</span> is precipitation <span class="math notranslate nohighlight">\([mm/day]\)</span>.</p>
<div class="admonition note" id="surface-runoff">
<p class="admonition-title">Note</p>
<p>Surface runoff <span class="math notranslate nohighlight">\(({R}_{s})\)</span> is finally calculated as total daily runoff from land minus groundwater recharge.</p>
</div>
</section>
</section>
<section id="references">
<h1>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h1>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id7" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id2">1</a>,<a role="doc-backlink" href="#id4">2</a>)</span>
<p>Müller Schmied, H., Cáceres, D., Eisner, S., Flörke, M., Herbert, C., Niemann, C., Peiris, T. A., Popat, E., Portmann, F. T., Reinecke, R., Schumacher, M., Shadkam, S., Telteu, C.E., Trautmann, T., &amp; Döll, P. (2021). The global water resources and use model WaterGAP v2.2d: model description and evaluation. Geoscientific Model Development, 14(2), 1037–1079. <a class="reference external" href="https://doi.org/10.5194/gmd-14-1037-2021">https://doi.org/10.5194/gmd-14-1037-2021</a></p>
</aside>
<aside class="footnote brackets" id="id8" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">2</a><span class="fn-bracket">]</span></span>
<p>Batjes, N. H.: ISRIC-WISE derived soil properties on a 5 by 5 arc-minutes global grid (ver. 1.2), Tech. Rep. 2012/01, ISRIC–World Soil Information, Wageningen, 2012.</p>
</aside>
<aside class="footnote brackets" id="id9" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">3</a><span class="fn-bracket">]</span></span>
<p>Bergström, S.: The HBV model, in: Computer models of watershed hydrology, edited by: Singh, V., Water Resources Publications, Lone Tree, USA, 443–476, 1995</p>
</aside>
<aside class="footnote brackets" id="id10" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id6">4</a><span class="fn-bracket">]</span></span>
<p>Döll, P. and Fiedler, K.: Global-scale modeling of groundwater recharge, Hydrol. Earth Syst. Sci., 12, 863–885, <a class="reference external" href="https://doi.org/10.5194/hess-12-863-2008">https://doi.org/10.5194/hess-12-863-2008</a>, 2008.</p>
</aside>
</aside>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="snow.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Snow</p>
      </div>
    </a>
    <a class="right-next"
       href="../lateral_water_balance/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Lateral Water Balance</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Soil</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#soil.soil_water_balance"><code class="docutils literal notranslate"><span class="pre">soil_water_balance()</span></code></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#water-balance">Water balance</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inflows">Inflows</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>

  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/model_processes/vertical_water_balance/soil.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2025, ReWaterGAP.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>